<!--
 - Created by Denise.Baker on 4/13/24.
 -->

<!-- Task List Lwc -->
<template>

        <template if:false={taskListClosed}>
            <article class="slds-card">
            <div class="slds-card__header slds-grid task-card-header">

                <header class="slds-media slds-media_center slds-has-flexi-truncate">
                    <div class="slds-media__figure">
                                            <span class="slds-icon_container slds-icon-standard-account"
                                                  title="All Projects">
                                                <lightning-icon
                                                        icon-name="standard:work_step_template">
                                                </lightning-icon>
                                            <span class="slds-assistive-text">All Tasks</span>
                                            </span>
                    </div>

                    <div class="slds-media__body">
                        <h2 class="slds-card__header-title task-header">
<!--                            <div class="">-->
                                <span>All Tasks</span>
<!--                            </div>-->
                        </h2>
                    </div>
                    <div class="slds-grid_align-end new-button">
                        <lightning-button variant="neutral" label="New" title="Primary action"
                                          onclick={handleNewModal}
                                          class="slds-grid_align-end ">
                        </lightning-button>
                    </div>

                </header>
            </div>
            <div class="slds-box slds-theme_default">
                <lightning-input
                        label="Search Term"
                        variant="label-hidden"
                        placeholder="Search"
                        type="search"
                        value={searchKey}
                        onchange={handleSearch}
                        class="search-box"
                >
                </lightning-input>
            </div>
            <div class="slds-m-around_small">
                <lightning-datatable
                        key-field="id"
                        data={filteredTasks}
                        columns={cols}
                        onrowaction={handleRowAction}
                        sorted-by={sortBy}
                        sorted-direction={sortDirection}
                        onsort={doSorting}
                        hide-checkbox-column="true"
                >
                </lightning-datatable>
            </div>
            </article>
        </template>

<!---------- Single Task Card------------------------->
        <template if:true={viewSingleTask}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                     aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">

                <div class="slds-modal__container new-modal-box">
                    <!-- Modal/Popup Box LWC header here -->
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                                title="Close" onclick={closeDetailModal}>
                            <lightning-icon icon-name="utility:close"
                                            alternative-text="close"
                                            variant="inverse"
                                            size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>

                    </header>
                    <!-- Modal/Popup Box LWC body starts here -->
                    <div class="slds-modal__content slds-p-around_xx-small" id="modal-content-id-12">
                        <c-task-card record-id={taskId}></c-task-card>
                    </div>

                </div>
            </section>
        </template>

        <!---------- Error Handler ------------------------->
        <template if:true={error}>
            <c-error-panel errors={error}></c-error-panel>
        </template>

        <!---------------- New Task Modal --------------------------->
        <template if:true={newModalOpen}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                     aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">

                <div class="slds-modal__container new-modal-box">
                    <!-- Modal/Popup Box LWC header here -->
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                                title="Close" onclick={closeNewModal}>
                            <lightning-icon icon-name="utility:close"
                                            alternative-text="close"
                                            variant="inverse"
                                            size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>

                    </header>
                    <!-- Modal/Popup Box LWC body starts here -->
                    <div class="slds-modal__content slds-p-around_xx-small" id="modal-content-id-1">
                        <c-create-task-card record-id={taskId} onclosemodal={handleCloseTaskModal}></c-create-task-card>
                    </div>

                </div>
            </section>
        </template>

        <!---------------- Update Task Modal --------------------------->
        <template if:true={editModalOpen}>
            <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
                     aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">

                <div class="slds-modal__container new-modal-box">
                    <!-- Modal/Popup Box LWC header here -->
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                                title="Close" onclick={closeEditModal}>
                            <lightning-icon icon-name="utility:close"
                                            alternative-text="close"
                                            variant="inverse"
                                            size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>

                    </header>
                    <!-- Modal/Popup Box LWC body starts here -->
                    <div class="slds-modal__content slds-p-around_xx-small" id="edit-modal-content-id-9">
                        <c-update-task-card record-id={taskId}></c-update-task-card>
                    </div>

                </div>
            </section>
        </template>

</template>